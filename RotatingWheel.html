<head>
    <meta description="Hue cycle."/>
    <meta publisher="WhirlwindFX" />
    <meta property="speed" label="Cycle Speed" type="number" min="0" max="10" default="3">
    <meta property="baseColor" label="Colorpicker Control" type="color" default="#c600ff" min="0" max="360"/>
</head>
    
<body style="margin: 0; padding: 0;">
    <canvas id="exCanvas" width="1280" height="740" style="width: 100%; height: 100%"></canvas>
</body>
    
<script type="text/javascript" src="engine.js"></script><script>
    // Defines meta variables, used for dev
    var speed = 1
    var baseColor = "#c600ff"
    //

    let baseFrame = [
        [198/4, 0, 255/4],
        [198, 0, 255],
        [198, 0, 255],
        [198/4, 0, 255/4],
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
    ]
    const calculateNewAnimationState = (animationState) => {
        let nextFrame = []
        resetPixels(nextFrame)
        let currentPixel = animationState.extraFields.currentPixel
        let currentColor = hexToRgb(baseColor)

        nextFrame[antiCycle(currentPixel)] = scale3Vector(currentColor, 0.25)
        nextFrame[currentPixel] = currentColor
        nextFrame[cycle(currentPixel)] = currentColor
        nextFrame[cycles2(currentPixel)] = scale3Vector(currentColor, 0.25) 

        return {...animationState, nextFrame, extraFields: { currentPixel: antiCycle(currentPixel) } }
    }
    let defaultState = { currentPixel: 0 }
    let update = initEngine(calculateNewAnimationState, defaultState, baseFrame)

    window.requestAnimationFrame(update)
</script>